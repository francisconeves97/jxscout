import fs from "fs";
import path from "path";
import { expect, test } from "vitest";
import { discoverChunks } from "../discoverer/discoverer.js";

const readFile = (path: string): string => {
  return fs.readFileSync(path, "utf-8");
};

interface DiscovererTestCase {
  jsFileName: string;
  expectedChunks: string[];
}

const testCases: DiscovererTestCase[] = [
  {
    jsFileName: "1.js",
    expectedChunks: [
      "static/chunks/0.js",
      "static/chunks/1.js",
      "static/chunks/2.js",
      "static/chunks/3.js",
      "static/chunks/4.js",
    ],
  },
  {
    jsFileName: "2.js",
    expectedChunks: [
      "normal.js",
      "preloaded3.js",
      "preloaded2.js",
      "inner2.js",
      "inner.js",
      "preloaded.js",
    ],
  },
  {
    jsFileName: "3.js",
    expectedChunks: ["js/442.03088b33.js", "js/990.5ef7932f.js"],
  },
  {
    jsFileName: "4.js",
    expectedChunks: [
      "js/resources_js_components_Debt_AddDebt_AddDebt_js.js",
      "js/resources_js_components_Debt_DebtCategory_DebtCategory_js.js",
      "js/resources_js_components_Expense_Components_DashBoard_DashBoard_js.js",
      "js/resources_js_components_Expense_Components_ExpenseCategory_ExpenseCategory_js.js",
      "js/resources_js_components_Expense_Components_MakePayment_Category_Category_js.js",
      "js/resources_js_components_Expense_Components_MakePayment_Payment_js.js",
      "js/resources_js_components_Expense_Components_Summary_Summary_js.js",
    ],
  },
  {
    jsFileName: "5.js",
    expectedChunks: [
      "static/chunks/122.cda73d6ec595d1bb.js",
      "static/chunks/319.b6e5b5c59aee0b5d.js",
      "static/chunks/634.1fc013be8f4a1539.js",
      "static/chunks/cc8f0cfa.ba53b43d4c939170.js",
    ],
  },
  {
    jsFileName: "6.js",
    expectedChunks: [],
  },
  // TODO: 7.js has a chunk loading function, so we should be at least bruteforcing
  // however since it doesn't have the "Loading chunk " fingerprint, it is being disregarded
  {
    jsFileName: "7.js",
    expectedChunks: [],
  },
  {
    jsFileName: "8.js",
    expectedChunks: [
      "static/chunks/0.js",
      "static/chunks/1.js",
      "static/chunks/2.js",
      "static/chunks/3.js",
      "static/chunks/4.js",
    ],
  },
  {
    jsFileName: "9.js",
    expectedChunks: [
      "1744.8c8cc2f4.chunk.js",
      "1776.f2fecb60.chunk.js",
      "2019.9fd14948.chunk.js",
      "3219.41584904.chunk.js",
      "3710.014c6a47.chunk.js",
      "3783.d98a9039.chunk.js",
      "4549.0fe1f5c8.chunk.js",
      "5125.a6fa64d4.chunk.js",
      "5158.525602c5.chunk.js",
      "5593.0c81faeb.chunk.js",
      "5862.958ce6d4.chunk.js",
      "6822.60e59637.chunk.js",
      "7692.b729d55b.chunk.js",
      "866.03d5d438.chunk.js",
      "9034.dfc774a7.chunk.js",
      "9170.e25d0094.chunk.js",
      "9381.b12f5f67.chunk.js",
      "9723.8d1e2f12.chunk.js",
      "Admin-authenticatedApp.9a2835ba.chunk.js",
      "Admin_InternalErrorPage.3927ac41.chunk.js",
      "Admin_homePage.088de654.chunk.js",
      "Admin_marketplace.b2180ab6.chunk.js",
      "Admin_pluginsPage.9c220e58.chunk.js",
      "Admin_profilePage.7cd849a2.chunk.js",
      "Admin_settingsPage.b6ca3e9d.chunk.js",
      "Upload_ConfigureTheView.e6684aa8.chunk.js",
      "admin-app.1b335ecf.chunk.js",
      "admin-edit-roles-page.de777a0c.chunk.js",
      "admin-edit-users.807f7084.chunk.js",
      "admin-roles-list.330f8136.chunk.js",
      "admin-users.f3475c6d.chunk.js",
      "api-tokens-create-page.226d4226.chunk.js",
      "api-tokens-edit-page.5c83609c.chunk.js",
      "api-tokens-list-page.4c5e0152.chunk.js",
      "ar-json.10b625a8.chunk.js",
      "audit-logs-settings-page.7cb588e2.chunk.js",
      "ca-json.8a255a50.chunk.js",
      "content-manager.2acd99cd.chunk.js",
      "content-type-builder-list-view.522558e8.chunk.js",
      "content-type-builder-translation-ar-json.13271e3b.chunk.js",
      "content-type-builder-translation-cs-json.f90a3c08.chunk.js",
      "content-type-builder-translation-de-json.39973e41.chunk.js",
      "content-type-builder-translation-dk-json.dcf3a90a.chunk.js",
      "content-type-builder-translation-en-json.42aa3c49.chunk.js",
      "content-type-builder-translation-es-json.dbb06c6d.chunk.js",
      "content-type-builder-translation-fr-json.4e12f010.chunk.js",
      "content-type-builder-translation-id-json.ef57a004.chunk.js",
      "content-type-builder-translation-it-json.a8f7b7a9.chunk.js",
      "content-type-builder-translation-ja-json.a3d86ea9.chunk.js",
      "content-type-builder-translation-ko-json.f5878d12.chunk.js",
      "content-type-builder-translation-ms-json.9f5da4dc.chunk.js",
      "content-type-builder-translation-nl-json.11251923.chunk.js",
      "content-type-builder-translation-pl-json.dcd46f34.chunk.js",
      "content-type-builder-translation-pt-BR-json.3d9cf514.chunk.js",
      "content-type-builder-translation-pt-json.c3f8755e.chunk.js",
      "content-type-builder-translation-ru-json.5ccafc1e.chunk.js",
      "content-type-builder-translation-sk-json.98681c2b.chunk.js",
      "content-type-builder-translation-sv-json.39ef2697.chunk.js",
      "content-type-builder-translation-th-json.38fc7b31.chunk.js",
      "content-type-builder-translation-tr-json.9df80595.chunk.js",
      "content-type-builder-translation-uk-json.1c6ec71a.chunk.js",
      "content-type-builder-translation-zh-Hans-json.5769ed28.chunk.js",
      "content-type-builder-translation-zh-json.ea71e172.chunk.js",
      "content-type-builder.b821f857.chunk.js",
      "cs-json.9fb1ade4.chunk.js",
      "de-json.1f4ab9f7.chunk.js",
      "dk-json.ff43ceda.chunk.js",
      "email-settings-page.84bffda2.chunk.js",
      "email-translation-ar-json.5cd751d4.chunk.js",
      "email-translation-cs-json.f00509ad.chunk.js",
      "email-translation-de-json.6b4de591.chunk.js",
      "email-translation-dk-json.1d8ecfc3.chunk.js",
      "email-translation-en-json.232a03b9.chunk.js",
      "email-translation-es-json.19f7a09f.chunk.js",
      "email-translation-fr-json.cf5027f9.chunk.js",
      "email-translation-id-json.aa82d066.chunk.js",
      "email-translation-it-json.a7ae86a7.chunk.js",
      "email-translation-ja-json.1de75653.chunk.js",
      "email-translation-ko-json.3cfe361b.chunk.js",
      "email-translation-ms-json.5eace727.chunk.js",
      "email-translation-nl-json.bf7a614f.chunk.js",
      "email-translation-pl-json.488f1acf.chunk.js",
      "email-translation-pt-BR-json.12ae42a4.chunk.js",
      "email-translation-pt-json.85e7825d.chunk.js",
      "email-translation-ru-json.8cc5e503.chunk.js",
      "email-translation-sk-json.23a8c361.chunk.js",
      "email-translation-th-json.9dec8bd6.chunk.js",
      "email-translation-tr-json.16caa1bc.chunk.js",
      "email-translation-uk-json.804053d5.chunk.js",
      "email-translation-vi-json.9a7bad95.chunk.js",
      "email-translation-zh-Hans-json.b040ef57.chunk.js",
      "email-translation-zh-json.c2b9f4c6.chunk.js",
      "en-json.a3850793.chunk.js",
      "es-json.9fc2120f.chunk.js",
      "eu-json.23d9e3c3.chunk.js",
      "fr-json.e90c673b.chunk.js",
      "gu-json.7ea32eda.chunk.js",
      "he-json.1034b0a7.chunk.js",
      "hi-json.da21cf04.chunk.js",
      "highlight.js.5f146517.chunk.js",
      "hu-json.f24153c8.chunk.js",
      "i18n-settings-page.32cf1ec7.chunk.js",
      "i18n-translation-de-json.2bea9c9e.chunk.js",
      "i18n-translation-dk-json.60b500d5.chunk.js",
      "i18n-translation-en-json.a2e91b29.chunk.js",
      "i18n-translation-es-json.2909f96f.chunk.js",
      "i18n-translation-fr-json.23ea6151.chunk.js",
      "i18n-translation-ko-json.0800405c.chunk.js",
      "i18n-translation-pl-json.71b880e2.chunk.js",
      "i18n-translation-ru-json.8f1a8c81.chunk.js",
      "i18n-translation-tr-json.95dfb6f1.chunk.js",
      "i18n-translation-zh-Hans-json.610f823d.chunk.js",
      "i18n-translation-zh-json.da016e7a.chunk.js",
      "id-json.17ff7372.chunk.js",
      "input-component.503f3739.chunk.js",
      "it-json.da617f54.chunk.js",
      "ja-json.23e6bf87.chunk.js",
      "ko-json.2b169c57.chunk.js",
      "ml-json.577b23a9.chunk.js",
      "ms-json.ce33a580.chunk.js",
      "nl-json.d3b279f8.chunk.js",
      "no-json.b06b1cfa.chunk.js",
      "pl-json.031a3065.chunk.js",
      "pt-BR-json.7d663620.chunk.js",
      "pt-json.abfeb94e.chunk.js",
      "review-workflows-settings.7166a9b8.chunk.js",
      "ru-json.615eb895.chunk.js",
      "sa-json.6d6b12fd.chunk.js",
      "settings-page.858c5eec.chunk.js",
      "sk-json.c8d3df0a.chunk.js",
      "sso-settings-page.94a30ec3.chunk.js",
      "sv-json.bfd2a623.chunk.js",
      "th-json.999ab8bd.chunk.js",
      "tr-json.e3cc8487.chunk.js",
      "transfer-tokens-create-page.8b36328d.chunk.js",
      "transfer-tokens-edit-page.e27f15de.chunk.js",
      "transfer-tokens-list-page.9f70c45f.chunk.js",
      "uk-json.699435c7.chunk.js",
      "upload-settings.5669baf8.chunk.js",
      "upload-translation-ca-json.d0ee250a.chunk.js",
      "upload-translation-de-json.0455147e.chunk.js",
      "upload-translation-dk-json.c6b6f99e.chunk.js",
      "upload-translation-en-json.57a2163a.chunk.js",
      "upload-translation-es-json.ceb9e47a.chunk.js",
      "upload-translation-fr-json.eed57fd2.chunk.js",
      "upload-translation-he-json.65c3846c.chunk.js",
      "upload-translation-it-json.5706e130.chunk.js",
      "upload-translation-ja-json.4fc231cc.chunk.js",
      "upload-translation-ko-json.6b40fa3f.chunk.js",
      "upload-translation-ms-json.b60d8ebf.chunk.js",
      "upload-translation-pl-json.8686e04b.chunk.js",
      "upload-translation-pt-BR-json.e2a70246.chunk.js",
      "upload-translation-pt-json.3cecad29.chunk.js",
      "upload-translation-ru-json.2c9b5144.chunk.js",
      "upload-translation-sk-json.3f536913.chunk.js",
      "upload-translation-th-json.0c7d594f.chunk.js",
      "upload-translation-tr-json.113415a6.chunk.js",
      "upload-translation-uk-json.aab36e61.chunk.js",
      "upload-translation-zh-Hans-json.3e9496c7.chunk.js",
      "upload-translation-zh-json.5666c406.chunk.js",
      "upload.67d91094.chunk.js",
      "users-advanced-settings-page.2c6cdaf7.chunk.js",
      "users-email-settings-page.45a92ae4.chunk.js",
      "users-permissions-translation-ar-json.c6eeb807.chunk.js",
      "users-permissions-translation-cs-json.acfaae74.chunk.js",
      "users-permissions-translation-de-json.41353c63.chunk.js",
      "users-permissions-translation-dk-json.d8802bf1.chunk.js",
      "users-permissions-translation-en-json.f3b139bc.chunk.js",
      "users-permissions-translation-es-json.1e5ef163.chunk.js",
      "users-permissions-translation-fr-json.51213ca2.chunk.js",
      "users-permissions-translation-id-json.c49fd636.chunk.js",
      "users-permissions-translation-it-json.8a9976ba.chunk.js",
      "users-permissions-translation-ja-json.8e897e48.chunk.js",
      "users-permissions-translation-ko-json.56823ef1.chunk.js",
      "users-permissions-translation-ms-json.ae2bdcd8.chunk.js",
      "users-permissions-translation-nl-json.b2899c23.chunk.js",
      "users-permissions-translation-pl-json.7561d887.chunk.js",
      "users-permissions-translation-pt-BR-json.68dc7c5d.chunk.js",
      "users-permissions-translation-pt-json.c826be69.chunk.js",
      "users-permissions-translation-ru-json.4eb4a11a.chunk.js",
      "users-permissions-translation-sk-json.a8a812b8.chunk.js",
      "users-permissions-translation-sv-json.8b9a8925.chunk.js",
      "users-permissions-translation-th-json.d4509302.chunk.js",
      "users-permissions-translation-tr-json.99fe17eb.chunk.js",
      "users-permissions-translation-uk-json.8b254be1.chunk.js",
      "users-permissions-translation-vi-json.6616ecc7.chunk.js",
      "users-permissions-translation-zh-Hans-json.0a216986.chunk.js",
      "users-permissions-translation-zh-json.88401dfd.chunk.js",
      "users-providers-settings-page.98855bb0.chunk.js",
      "users-roles-settings-page.687954fd.chunk.js",
      "vi-json.82231f2a.chunk.js",
      "webhook-edit-page.1eb13be5.chunk.js",
      "webhook-list-page.b3c600cd.chunk.js",
      "zh-Hans-json.830bbf25.chunk.js",
      "zh-json.adf6dd9b.chunk.js",
    ],
  },
  {
    jsFileName: "10.js",
    expectedChunks: [
      "js/chunk.0.js",
      "js/chunk.1.js",
      "js/chunk.2.js",
      "js/chunk.3.js",
      "js/chunk.4.js",
      "js/chunk.MaskWallet.js",
      "js/chunk.npm-ns.0xproject.utils.js",
      "js/chunk.npm-ns.balancer-labs.sor.js",
      "js/chunk.npm-ns.blocto.fcl.js",
      "js/chunk.npm-ns.blocto.protobuf.js",
      "js/chunk.npm-ns.ceramicnetwork.blockchain-utils-linking.js",
      "js/chunk.npm-ns.ceramicnetwork.common.js",
      "js/chunk.npm-ns.ceramicnetwork.streamid.js",
      "js/chunk.npm-ns.ceramicstudio.idx.js",
      "js/chunk.npm-ns.cyberlab.cyberconnect.js",
      "js/chunk.npm-ns.dimensiondev.mask-wallet-core.js",
      "js/chunk.npm-ns.ethersphere.bee-js.js",
      "js/chunk.npm-ns.ethersproject.abstract-signer.js",
      "js/chunk.npm-ns.ethersproject.contracts.js",
      "js/chunk.npm-ns.ethersproject.providers.js",
      "js/chunk.npm-ns.ethersproject.wordlists.js",
      "js/chunk.npm-ns.improbable-eng.grpc-web.js",
      "js/chunk.npm-ns.metamask.eth-sig-util.js",
      "js/chunk.npm-ns.metamask.inpage-provider.js",
      "js/chunk.npm-ns.metaplex-foundation.mpl-auction.js",
      "js/chunk.npm-ns.metaplex-foundation.mpl-core.js",
      "js/chunk.npm-ns.metaplex-foundation.mpl-metaplex.js",
      "js/chunk.npm-ns.metaplex-foundation.mpl-token-metadata.js",
      "js/chunk.npm-ns.metaplex-foundation.mpl-token-vault.js",
      "js/chunk.npm-ns.metaplex.js.js",
      "js/chunk.npm-ns.pedrouid.iso-crypto.js",
      "js/chunk.npm-ns.portto.sdk.js",
      "js/chunk.npm-ns.snapshot-labs.snapshot.js.js",
      "js/chunk.npm-ns.solana.buffer-layout.js",
      "js/chunk.npm-ns.solana.spl-token-registry.js",
      "js/chunk.npm-ns.solana.spl-token.js",
      "js/chunk.npm-ns.solana.web3.js.js",
      "js/chunk.npm-ns.stablelib.ed25519.js",
      "js/chunk.npm-ns.uniswap.v2-sdk.js",
      "js/chunk.npm-ns.uniswap.v3-periphery.js",
      "js/chunk.npm-ns.uniswap.v3-sdk.js",
      "js/chunk.npm-ns.walletconnect.core.js",
      "js/chunk.npm.3id-did-provider.js",
      "js/chunk.npm.aes-js.js",
      "js/chunk.npm.arweave.js",
      "js/chunk.npm.axios.js",
      "js/chunk.npm.bip39.js",
      "js/chunk.npm.blob-polyfill.js",
      "js/chunk.npm.borc.js",
      "js/chunk.npm.cborg.js",
      "js/chunk.npm.color-convert.js",
      "js/chunk.npm.crypto-js.js",
      "js/chunk.npm.d3-scale.js",
      "js/chunk.npm.d3-selection.js",
      "js/chunk.npm.d3-transition.js",
      "js/chunk.npm.d3-voronoi.js",
      "js/chunk.npm.debug.js",
      "js/chunk.npm.did-jwt.js",
      "js/chunk.npm.dompurify.js",
      "js/chunk.npm.ef-core.js",
      "js/chunk.npm.engine.io-client.js",
      "js/chunk.npm.engine.io-parser.js",
      "js/chunk.npm.eth-rpc-errors.js",
      "js/chunk.npm.ethereumjs-abi.js",
      "js/chunk.npm.fast-json-patch.js",
      "js/chunk.npm.fortmatic.js",
      "js/chunk.npm.html-to-image.js",
      "js/chunk.npm.ipfs-http-client.js",
      "js/chunk.npm.json-rpc-engine.js",
      "js/chunk.npm.json2csv.js",
      "js/chunk.npm.jsonschema.js",
      "js/chunk.npm.key-did-provider-ed25519.js",
      "js/chunk.npm.lodash.clonedeep.js",
      "js/chunk.npm.lodash.js",
      "js/chunk.npm.multiaddr.js",
      "js/chunk.npm.multiformats.js",
      "js/chunk.npm.mustache.js",
      "js/chunk.npm.near-api-js.js",
      "js/chunk.npm.opensea-js.js",
      "js/chunk.npm.protobufjs.js",
      "js/chunk.npm.qrcode-generator.js",
      "js/chunk.npm.react-draggable.js",
      "js/chunk.npm.react-feather.js",
      "js/chunk.npm.react-highlight-words.js",
      "js/chunk.npm.react-hook-form.js",
      "js/chunk.npm.regenerator-runtime.js",
      "js/chunk.npm.remarkable.js",
      "js/chunk.npm.rpc-utils.js",
      "js/chunk.npm.rpc-websockets.js",
      "js/chunk.npm.rxjs.js",
      "js/chunk.npm.socket.io-client.js",
      "js/chunk.npm.store.js",
      "js/chunk.npm.superstruct.js",
      "js/chunk.npm.tweetnacl.js",
      "js/chunk.npm.web-streams-polyfill.js",
      "js/chunk.npm.wyvern-js.js",
      "js/chunk.npm.wyvern-schemas.js",
      "js/chunk.npm.zod.js",
      "js/npm.history.js",
      "js/npm.react-router.js",
    ],
  },
  {
    jsFileName: "11.js",
    expectedChunks: [
      "js/app_Modules_BackupDb_Inertia_Edit_js.js?id=e185594aac09b6bf179d",
      "js/app_Modules_BackupDb_Inertia_Form_js.js?id=c6d222d22f83fb3b7099",
      "js/app_Modules_BackupDb_Inertia_Index_js-node_modules_moment_locale_sync_recursive_.js?id=9ffc889be7e0f335d817",
      "js/app_Modules_BackupDb_Inertia_Restore_js.js?id=c1d21c5efdd1b9a9b346",
      "js/app_Modules_BackupDb_Inertia_Show_js.js?id=79afd2e17af24466dea3",
      "js/app_Modules_Config_Inertia_Create_js.js?id=b4719a32c4890254fc71",
      "js/app_Modules_Config_Inertia_Edit_js.js?id=c0ceca223f61438035db",
      "js/app_Modules_Config_Inertia_Form_js.js?id=999c3db33959dcca3062",
      "js/app_Modules_Config_Inertia_Index_js.js?id=83e789159383681451df",
      "js/app_Modules_Config_Inertia_Show_js.js?id=76e09f021b103d7e4c16",
      "js/app_Modules_Dashboard_Inertia_Index_js.js?id=f9317ea1b25a15875f64",
      "js/app_Modules_Dashboard_Inertia_Kamuflase_js.js?id=a1236b9bec6392480f06",
      "js/app_Modules_Dashboard_Inertia_Profil_js-node_modules_moment_locale_sync_recursive_.js?id=b13ad4086e4cb6da83ee",
      "js/app_Modules_Dokumen_Inertia_Create_js.js?id=65ceb927ed54fe9a6be2",
      "js/app_Modules_Dokumen_Inertia_Edit_js.js?id=89d8bea677f6427cf2c8",
      "js/app_Modules_Dokumen_Inertia_Form_js.js?id=9fa3fcd0db67ddebaea8",
      "js/app_Modules_Dokumen_Inertia_Index_js.js?id=b877758ee50f936b5867",
      "js/app_Modules_Dokumen_Inertia_Show_js.js?id=37e65ce215bc0e1e2b7c",
      "js/app_Modules_Log_Inertia_Create_js.js?id=16ddcb64def560bff209",
      "js/app_Modules_Log_Inertia_Edit_js.js?id=d9c8118fa6b67e80a662",
      "js/app_Modules_Log_Inertia_Form_js.js?id=dad63e5d2b83c375059a",
      "js/app_Modules_Log_Inertia_Index_js-node_modules_moment_locale_sync_recursive_.js?id=d2448e39dcef5abeb1bc",
      "js/app_Modules_Log_Inertia_Show_js-node_modules_moment_locale_sync_recursive_.js?id=403c69b6233868c488db",
      "js/app_Modules_MenuGrup_Inertia_Create_js.js?id=9cb35ed911744e71bd85",
      "js/app_Modules_MenuGrup_Inertia_Edit_js.js?id=db379a360a6d1b6c78cc",
      "js/app_Modules_MenuGrup_Inertia_Form_js.js?id=7ff7a5d1ac18fd008cac",
      "js/app_Modules_MenuGrup_Inertia_Index_js.js?id=00a70ca8a215ad7aec69",
      "js/app_Modules_MenuGrup_Inertia_Show_js.js?id=e4b247c39e73d25fa45d",
      "js/app_Modules_Module_Inertia_Create_js.js?id=3cad9484f4735fb1645e",
      "js/app_Modules_Module_Inertia_Edit_js.js?id=b9256bc601d13575a8de",
      "js/app_Modules_Module_Inertia_Form_js.js?id=4c85163e9993e03f2b70",
      "js/app_Modules_Module_Inertia_Index_js.js?id=6a492847a6036774e7c9",
      "js/app_Modules_Module_Inertia_Show_js.js?id=d2c39fa159cd41ab666d",
      "js/app_Modules_RefJnsDokumen_Inertia_Create_js.js?id=2aa5e33877f01941866c",
      "js/app_Modules_RefJnsDokumen_Inertia_Edit_js.js?id=f3133dbd3bc8fc62332a",
      "js/app_Modules_RefJnsDokumen_Inertia_Form_js.js?id=7c66e9d5342e6888a747",
      "js/app_Modules_RefJnsDokumen_Inertia_Index_js.js?id=5c3a537f5f43c8925138",
      "js/app_Modules_RefJnsDokumen_Inertia_Show_js.js?id=39cd2b6c38321bb20fef",
      "js/app_Modules_RolePrivilege_Inertia_Create_js.js?id=d1514b15506b6dc24afa",
      "js/app_Modules_RolePrivilege_Inertia_Edit_js.js?id=55ef9066d4346994faf1",
      "js/app_Modules_RolePrivilege_Inertia_Form_js.js?id=8e360591f80e2159e42e",
      "js/app_Modules_RolePrivilege_Inertia_Index_js.js?id=87336f08b01d56cc18d1",
      "js/app_Modules_RolePrivilege_Inertia_Show_js.js?id=1f6c677e51d614d449a9",
      "js/app_Modules_Role_Inertia_Create_js.js?id=e9074fab79d438074209",
      "js/app_Modules_Role_Inertia_Edit_js.js?id=5c039fb23775e250a92a",
      "js/app_Modules_Role_Inertia_Form_js.js?id=2ac52311754f9f00c536",
      "js/app_Modules_Role_Inertia_Index_js.js?id=e7b3adaba8060442bae8",
      "js/app_Modules_Role_Inertia_Show_js.js?id=32bb0aae0c53ca953374",
      "js/app_Modules_Users_Inertia_Create_js.js?id=48c48ea5d1d94d0139e8",
      "js/app_Modules_Users_Inertia_Edit_js.js?id=d5544d2150210b482df2",
      "js/app_Modules_Users_Inertia_Form_js.js?id=c6b83802a0a4c841d184",
      "js/app_Modules_Users_Inertia_Index_js.js?id=3db96463707d0fa60deb",
      "js/app_Modules_Users_Inertia_Show_js.js?id=62639e6030207c997a31",
      "js/resources_js_Pages_Auth_Login_js.js?id=8dc7d97f7ab3dc9273e8",
      "js/resources_js_Pages_Error_js.js?id=cc1ea7d4313cd38bbea3",
    ],
  },
  {
    jsFileName: "12.js",
    expectedChunks: [
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-10_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-11_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-12_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-13_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-14_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-15_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-16_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-17_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-1_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-2_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-3_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-4_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-5_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-6_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-7_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-8_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-reg-9_json.js",
      "js/node_modules_ageesea_psgc-js_src_extract_geo-regions_json.js",
    ],
  },
  {
    jsFileName: "13.js",
    expectedChunks: [
      "0.js",
      "04f4d467c8355e0cce98.bundle.js",
      "1.js",
      "2.js",
      "3.js",
      "4.js",
      "6b76acc9eaf52001d003.bundle.js",
      "accordion.e9e0c47570d3bc2ea472.bundle.js",
      "alert.1ddc787a09e65acb8bd5.bundle.js",
      "counter.699093eac935b541cdfe.bundle.js",
      "image-carousel.11194c4f02ba1ff5ad84.bundle.js",
      "lightbox.48b7d7dfa0c8ff9ab7ae.bundle.js",
      "progress.f88c14a27e3da5dcc9d8.bundle.js",
      "tabs.e9db15b9aa8a58bcf375.bundle.js",
      "text-editor.723f26db489b3ec260a7.bundle.js",
      "text-path.a25111b02271055ec181.bundle.js",
      "toggle.f62080504158ea96ac4c.bundle.js",
      "video.a67431c1becbede4d80c.bundle.js",
    ],
  },
  {
    jsFileName: "14.js",
    expectedChunks: [
      "_next/static/chunks/111.966d38d82145b8a1.js",
      "_next/static/chunks/12.bdfd37f92d75cf7d.js",
      "_next/static/chunks/252f366e-31244fe4e46f0352.js",
      "_next/static/chunks/574.0482dee029ead182.js",
      "_next/static/chunks/72fdc299.30ae96a14bbe7770.js",
      "_next/static/chunks/95b64a6e-bebee6bbe663f390.js",
      "_next/static/chunks/ae51ba48.c917bf0006c816d5.js",
      "_next/static/chunks/bd1a647f.1779877271d2b82a.js",
      "_next/static/chunks/d0c16330.7eff1e15bf414cb1.js",
    ],
  },
  {
    jsFileName: "15.js",
    expectedChunks: [
      "static/js/bgb-sc-settle/0.3b027edf.chunk.js",
      "static/js/bgb-sc-settle/1.b27cc473.chunk.js",
      "static/js/bgb-sc-settle/10.03007c86.chunk.js",
      "static/js/bgb-sc-settle/11.7cd15495.chunk.js",
      "static/js/bgb-sc-settle/2.a3139a9e.chunk.js",
      "static/js/bgb-sc-settle/3.dc2b83d2.chunk.js",
      "static/js/bgb-sc-settle/34.46f36067.chunk.js",
      "static/js/bgb-sc-settle/35.7d8e841d.chunk.js",
      "static/js/bgb-sc-settle/36.e361f0ed.chunk.js",
      "static/js/bgb-sc-settle/37.e85eb87e.chunk.js",
      "static/js/bgb-sc-settle/38.35baf32c.chunk.js",
      "static/js/bgb-sc-settle/39.2a09b3fa.chunk.js",
      "static/js/bgb-sc-settle/4.77102073.chunk.js",
      "static/js/bgb-sc-settle/5.3db9f1d7.chunk.js",
      "static/js/bgb-sc-settle/6.a5a01958.chunk.js",
      "static/js/bgb-sc-settle/9.1fa25c4e.chunk.js",
      "static/js/bgb-sc-settle/agreement-signing.d416297d.chunk.js",
      "static/js/bgb-sc-settle/enterprise-entry.618b0095.chunk.js",
      "static/js/bgb-sc-settle/entity-relate.048a88fb.chunk.js",
      "static/js/bgb-sc-settle/entry-new-mall.edaf1d31.chunk.js",
      "static/js/bgb-sc-settle/graph.f5b58db0.chunk.js",
      "static/js/bgb-sc-settle/home-main.1e119672.chunk.js",
      "static/js/bgb-sc-settle/login-hosting.80aca311.chunk.js",
      "static/js/bgb-sc-settle/login-mms.84a2b5a1.chunk.js",
      "static/js/bgb-sc-settle/login-register.32d2cd8f.chunk.js",
      "static/js/bgb-sc-settle/login.086146dc.chunk.js",
      "static/js/bgb-sc-settle/main-message.6c4b2c22.chunk.js",
      "static/js/bgb-sc-settle/mall-info.353a4366.chunk.js",
      "static/js/bgb-sc-settle/modify-mobile.3b47e5ed.chunk.js",
      "static/js/bgb-sc-settle/order-detail.c5ae4e73.chunk.js",
      "static/js/bgb-sc-settle/order-list.49a4cbfb.chunk.js",
      "static/js/bgb-sc-settle/qualification.e53a8793.chunk.js",
      "static/js/bgb-sc-settle/relate-authorization.11e8f90e.chunk.js",
      "static/js/bgb-sc-settle/reset-password.a539bfed.chunk.js",
      "static/js/bgb-sc-settle/rule-center.088b0637.chunk.js",
      "static/js/bgb-sc-settle/seller-login.54b7adbb.chunk.js",
      "static/js/bgb-sc-settle/site-trusteeship.565ce82e.chunk.js",
    ],
  },
  {
    jsFileName: "16.js",
    expectedChunks: [
      "main.ce7042bc00745c5ef033.chunk.js",
      "polyfills.2caa283e11afd9ea391e.chunk.js",
      "styles.393605044edcf4d7e97b.chunk.js",
    ],
  },
  {
    jsFileName: "17.js",
    expectedChunks: [
      "0.215647de-1223.js",
      "1.215647de-1223.js",
      "2.215647de-1223.js",
      "3.215647de-1223.js",
      "4.215647de-1223.js",
    ],
  },
  {
    jsFileName: "18.js",
    expectedChunks: [
      "chunk.0.js",
      "chunk.1.js",
      "chunk.2.js",
      "chunk.3.js",
      "chunk.4.js",
      "chunk.AgentPreviewBrowserWrapper.js",
      "chunk.BuyTransaction.js",
      "chunk.BuyTransactionContainer.js",
      "chunk.HomePage.js",
      "chunk.InvitationPage.js",
      "chunk.MyPersonalSpacePage.js",
      "chunk.SellTransaction.js",
      "chunk.TransactionPage.js",
    ],
  },
  {
    jsFileName: "19.js",
    expectedChunks: [
      "0.b73eaee9a88f178d62ed.manager.bundle.js",
      "1.f296d183a17268696d73.manager.bundle.js",
      "10.9998ba67d65d81d20896.manager.bundle.js",
      "11.49c687eaa6261f8b7be2.manager.bundle.js",
      "12.c9538ed3766c96f289e7.manager.bundle.js",
      "5.fa71488e730c5c7f885f.manager.bundle.js",
      "6.8096ae4aadde0743697b.manager.bundle.js",
      "7.b34baecbd082bc7b188d.manager.bundle.js",
      "8.15577edffecf900a8de2.manager.bundle.js",
      "9.d7d85aa0a49a98f17218.manager.bundle.js",
    ],
  },
  {
    jsFileName: "20.js",
    expectedChunks: [
      "app_97cb7f4ace92ad1f5f84.js",
      "vendor_1ea3928b979dca3e791b.js",
    ],
  },
  {
    jsFileName: "21.js",
    expectedChunks: ["1.js", "2.js", "3.js", "4.js", "app.js"],
  },
  {
    jsFileName: "22.js",
    expectedChunks: ["js/0.js?id=c523e16615500fabc254"],
  },
  {
    jsFileName: "23.js",
    expectedChunks: [
      "js/button.e7f9415a2e000feaab02c86dd5802747.js",
      "js/dm_button.443ebd443503664187a11c2bdea4b296.js",
      "js/moment.cd19c6b67c2f5cf62643a0c94915ac9a.js",
      "js/periscope_on_air.2a64e13e06c13d3a9f08ffe7272b04e3.js",
      "js/timeline.16b53cc33aaa562f8f41a495bf720289.js",
      "js/tweet.b81b6d7af2d75db873cff6099e4f433a.js",
    ],
  },
  {
    jsFileName: "24.js",
    expectedChunks: ["js/manifest.97dafd45.js"],
  },
  {
    jsFileName: "25.js",
    expectedChunks: [
      "frameChunks/0.js",
      "frameChunks/1.js",
      "frameChunks/2.js",
      "frameChunks/3.js",
      "frameChunks/4.js",
    ],
  },
];

test.each(testCases)(
  "discoverer - $jsFileName",
  ({ jsFileName, expectedChunks }) => {
    const code = readFile(path.join(__dirname, "files", jsFileName));
    const chunks = discoverChunks(code, 5);

    expect(chunks.sort()).toEqual(expectedChunks.sort());
  }
);
